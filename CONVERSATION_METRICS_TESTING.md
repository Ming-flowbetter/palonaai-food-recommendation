# å¯¹è¯æŒ‡æ ‡ç›‘æ§æµ‹è¯•æŒ‡å—

## ğŸ“Š æ¦‚è¿°

å¯¹è¯æŒ‡æ ‡ç›‘æ§åŠŸèƒ½ç”¨äºå®æ—¶ç›‘æ§å¯¹è¯è´¨é‡å’Œç”¨æˆ·æ»¡æ„åº¦ï¼ŒåŒ…æ‹¬ä»¥ä¸‹æ ¸å¿ƒæŒ‡æ ‡ï¼š

- **ç”¨æˆ·æ»¡æ„åº¦**: åŸºäºç”¨æˆ·åé¦ˆè®¡ç®—
- **å“åº”æ—¶é—´**: ç›‘æ§AIå“åº”é€Ÿåº¦
- **æ„å›¾è¯†åˆ«å‡†ç¡®ç‡**: è¯„ä¼°æ„å›¾è¯†åˆ«å‡†ç¡®æ€§
- **æƒ…æ„Ÿè¯†åˆ«å‡†ç¡®ç‡**: è¯„ä¼°æƒ…æ„Ÿåˆ†æå‡†ç¡®æ€§
- **å¯¹è¯é•¿åº¦**: ç»Ÿè®¡æ¶ˆæ¯æ•°é‡
- **äº¤äº’æ¬¡æ•°**: è®°å½•ç”¨æˆ·äº¤äº’é¢‘ç‡

## ğŸ§ª æµ‹è¯•æ–¹æ³•

### 1. è‡ªåŠ¨åŒ–æµ‹è¯•

#### è¿è¡Œæµ‹è¯•è„šæœ¬
```bash
# æœ¬åœ°æµ‹è¯•
python test_conversation_metrics.py

# çº¿ä¸Šæµ‹è¯•ï¼ˆä¿®æ”¹è„šæœ¬ä¸­çš„BASE_URLï¼‰
python test_conversation_metrics.py
```

#### æµ‹è¯•è„šæœ¬åŠŸèƒ½
- âœ… å¥åº·æ£€æŸ¥
- âœ… åŸºç¡€å¯¹è¯æŒ‡æ ‡æµ‹è¯•
- âœ… å¯¹è¯æŒ‡æ ‡APIæµ‹è¯•
- âœ… ç”¨æˆ·åé¦ˆå½±å“æµ‹è¯•
- âœ… ä¼šè¯ä¿¡æ¯æµ‹è¯•
- âœ… å¤šä¼šè¯æŒ‡æ ‡å¯¹æ¯”
- âœ… å®æ—¶ç›‘æ§æµ‹è¯•

### 2. æ‰‹åŠ¨æµ‹è¯•

#### 2.1 å¥åº·æ£€æŸ¥
```bash
curl -X GET "https://palonaai-food-recommendation.onrender.com/api/health"
```

**é¢„æœŸç»“æœ**:
```json
{
  "status": "healthy",
  "service": "PalonaAIèœå“æ¨èç³»ç»Ÿ",
  "version": "2.0.0",
  "features": [
    "æ™ºèƒ½å¯¹è¯",
    "æ„å›¾è¯†åˆ«",
    "æƒ…æ„Ÿåˆ†æ",
    "å®ä½“æå–",
    "ä¸ªæ€§åŒ–æ¨è",
    "ç”¨æˆ·åé¦ˆ"
  ]
}
```

#### 2.2 åˆ›å»ºæµ‹è¯•å¯¹è¯
```bash
curl -X POST "https://palonaai-food-recommendation.onrender.com/api/chat" \
  -H "Content-Type: application/json" \
  -d '{"message": "ä½ å¥½ï¼Œæˆ‘æƒ³åƒè¾£çš„èœ"}'
```

**é¢„æœŸç»“æœ**:
```json
{
  "response": "ä½ å¥½ï¼æ ¹æ®æ‚¨çš„åå¥½ï¼Œæˆ‘æ¨è...",
  "session_id": "uuid-string",
  "conversation_length": 2,
  "interaction_count": 1,
  "intent_scores": {"recommendation": 0.8, "preference": 0.6},
  "emotion_scores": {"neutral": 0.7},
  "entities": {"taste_preferences": ["spicy"]}
}
```

#### 2.3 è·å–å¯¹è¯æŒ‡æ ‡
```bash
curl -X GET "https://palonaai-food-recommendation.onrender.com/api/conversation-metrics/{session_id}"
```

**é¢„æœŸç»“æœ**:
```json
{
  "session_id": "uuid-string",
  "total_messages": 4,
  "user_satisfaction_score": 0.85,
  "average_response_time": 1.23,
  "intent_accuracy": 0.92,
  "emotion_recognition_accuracy": 0.88,
  "created_at": "2024-01-01T10:00:00",
  "updated_at": "2024-01-01T10:05:00"
}
```

#### 2.4 æäº¤ç”¨æˆ·åé¦ˆ
```bash
curl -X POST "https://palonaai-food-recommendation.onrender.com/api/feedback" \
  -H "Content-Type: application/json" \
  -d '{
    "session_id": "uuid-string",
    "message_id": "test_message",
    "rating": 5,
    "feedback_type": "positive",
    "comment": "æ¨èå¾ˆå‡†ç¡®ï¼"
  }'
```

**é¢„æœŸç»“æœ**:
```json
{
  "message": "åé¦ˆå·²æäº¤",
  "session_id": "uuid-string",
  "rating": 5,
  "feedback_type": "positive"
}
```

#### 2.5 è·å–ä¼šè¯ä¿¡æ¯
```bash
curl -X GET "https://palonaai-food-recommendation.onrender.com/api/session/{session_id}"
```

**é¢„æœŸç»“æœ**:
```json
{
  "session_id": "uuid-string",
  "conversation_length": 4,
  "interaction_count": 2,
  "user_preferences": {
    "taste_preferences": ["spicy"],
    "cuisine_preferences": ["chinese"]
  },
  "intent_history": [...],
  "emotion_history": [...],
  "created_at": "2024-01-01T10:00:00",
  "last_activity": "2024-01-01T10:05:00"
}
```

## ğŸ“ˆ æŒ‡æ ‡è¯´æ˜

### 1. ç”¨æˆ·æ»¡æ„åº¦ (user_satisfaction_score)
- **è®¡ç®—æ–¹å¼**: åŸºäºç”¨æˆ·åé¦ˆè¯„åˆ†è®¡ç®—
- **èŒƒå›´**: 0.0 - 1.0 (0% - 100%)
- **æ›´æ–°é¢‘ç‡**: æ¯æ¬¡æäº¤åé¦ˆæ—¶æ›´æ–°
- **æµ‹è¯•æ–¹æ³•**: æäº¤ä¸åŒè¯„åˆ†çš„åé¦ˆï¼Œè§‚å¯ŸæŒ‡æ ‡å˜åŒ–

### 2. å¹³å‡å“åº”æ—¶é—´ (average_response_time)
- **è®¡ç®—æ–¹å¼**: æ‰€æœ‰APIè°ƒç”¨çš„å¹³å‡å“åº”æ—¶é—´
- **å•ä½**: ç§’
- **æ›´æ–°é¢‘ç‡**: æ¯æ¬¡APIè°ƒç”¨æ—¶æ›´æ–°
- **æµ‹è¯•æ–¹æ³•**: è¿›è¡Œå¤šæ¬¡APIè°ƒç”¨ï¼Œè§‚å¯Ÿå“åº”æ—¶é—´ç»Ÿè®¡

### 3. æ„å›¾è¯†åˆ«å‡†ç¡®ç‡ (intent_accuracy)
- **è®¡ç®—æ–¹å¼**: åŸºäºå†å²å¯¹è¯çš„æ„å›¾è¯†åˆ«å‡†ç¡®æ€§
- **èŒƒå›´**: 0.0 - 1.0 (0% - 100%)
- **æ›´æ–°é¢‘ç‡**: æ¯æ¬¡å¯¹è¯æ—¶æ›´æ–°
- **æµ‹è¯•æ–¹æ³•**: å‘é€ä¸åŒç±»å‹çš„æ¶ˆæ¯ï¼Œè§‚å¯Ÿæ„å›¾è¯†åˆ«å‡†ç¡®æ€§

### 4. æƒ…æ„Ÿè¯†åˆ«å‡†ç¡®ç‡ (emotion_recognition_accuracy)
- **è®¡ç®—æ–¹å¼**: åŸºäºå†å²å¯¹è¯çš„æƒ…æ„Ÿåˆ†æå‡†ç¡®æ€§
- **èŒƒå›´**: 0.0 - 1.0 (0% - 100%)
- **æ›´æ–°é¢‘ç‡**: æ¯æ¬¡å¯¹è¯æ—¶æ›´æ–°
- **æµ‹è¯•æ–¹æ³•**: å‘é€ä¸åŒæƒ…æ„Ÿè‰²å½©çš„æ¶ˆæ¯ï¼Œè§‚å¯Ÿæƒ…æ„Ÿè¯†åˆ«å‡†ç¡®æ€§

## ğŸ” æµ‹è¯•åœºæ™¯

### åœºæ™¯1: åŸºç¡€å¯¹è¯æŒ‡æ ‡æµ‹è¯•
1. åˆ›å»ºæ–°ä¼šè¯
2. å‘é€å¤šæ¡æ¶ˆæ¯
3. æ£€æŸ¥å¯¹è¯é•¿åº¦å’Œäº¤äº’æ¬¡æ•°
4. éªŒè¯æŒ‡æ ‡è®¡ç®—æ­£ç¡®æ€§

### åœºæ™¯2: ç”¨æˆ·åé¦ˆå½±å“æµ‹è¯•
1. æäº¤æ­£é¢åé¦ˆ (rating: 5)
2. æäº¤è´Ÿé¢åé¦ˆ (rating: 1)
3. æäº¤ä¸­æ€§åé¦ˆ (rating: 3)
4. è§‚å¯Ÿæ»¡æ„åº¦æŒ‡æ ‡å˜åŒ–

### åœºæ™¯3: å®æ—¶ç›‘æ§æµ‹è¯•
1. æ¨¡æ‹ŸçœŸå®å¯¹è¯æµç¨‹
2. è®°å½•æ¯æ¬¡å“åº”æ—¶é—´
3. è§‚å¯ŸæŒ‡æ ‡å®æ—¶æ›´æ–°
4. éªŒè¯ç›‘æ§å‡†ç¡®æ€§

### åœºæ™¯4: å¤šä¼šè¯å¯¹æ¯”æµ‹è¯•
1. åˆ›å»ºå¤šä¸ªæµ‹è¯•ä¼šè¯
2. è¿›è¡Œä¸åŒçš„å¯¹è¯å†…å®¹
3. æäº¤ä¸åŒçš„åé¦ˆ
4. å¯¹æ¯”å„ä¼šè¯çš„æŒ‡æ ‡å·®å¼‚

## ğŸ› å¸¸è§é—®é¢˜æ’æŸ¥

### 1. æŒ‡æ ‡ä¸æ›´æ–°
**å¯èƒ½åŸå› **:
- ä¼šè¯IDä¸æ­£ç¡®
- åé¦ˆæäº¤å¤±è´¥
- æ•°æ®åº“è¿æ¥é—®é¢˜

**æ’æŸ¥æ–¹æ³•**:
```bash
# æ£€æŸ¥ä¼šè¯æ˜¯å¦å­˜åœ¨
curl -X GET "https://palonaai-food-recommendation.onrender.com/api/session/{session_id}"

# æ£€æŸ¥åé¦ˆæ˜¯å¦æäº¤æˆåŠŸ
curl -X POST "https://palonaai-food-recommendation.onrender.com/api/feedback" \
  -H "Content-Type: application/json" \
  -d '{"session_id": "test", "message_id": "test", "rating": 5, "feedback_type": "positive"}'
```

### 2. å“åº”æ—¶é—´å¼‚å¸¸
**å¯èƒ½åŸå› **:
- ç½‘ç»œå»¶è¿Ÿ
- æœåŠ¡å™¨è´Ÿè½½é«˜
- AIæœåŠ¡å“åº”æ…¢

**æ’æŸ¥æ–¹æ³•**:
```bash
# æµ‹è¯•å¥åº·æ£€æŸ¥å“åº”æ—¶é—´
time curl -X GET "https://palonaai-food-recommendation.onrender.com/api/health"

# æµ‹è¯•èŠå¤©APIå“åº”æ—¶é—´
time curl -X POST "https://palonaai-food-recommendation.onrender.com/api/chat" \
  -H "Content-Type: application/json" \
  -d '{"message": "æµ‹è¯•æ¶ˆæ¯"}'
```

### 3. å‡†ç¡®ç‡è®¡ç®—é”™è¯¯
**å¯èƒ½åŸå› **:
- æ„å›¾è¯†åˆ«ç®—æ³•é—®é¢˜
- æƒ…æ„Ÿåˆ†ææ¨¡å‹é—®é¢˜
- æ•°æ®é¢„å¤„ç†é”™è¯¯

**æ’æŸ¥æ–¹æ³•**:
```bash
# æµ‹è¯•æ„å›¾åˆ†æ
curl -X POST "https://palonaai-food-recommendation.onrender.com/api/analyze-intent" \
  -H "Content-Type: application/json" \
  -d '{"message": "æˆ‘æƒ³åƒè¾£çš„èœ"}'

# æµ‹è¯•æƒ…æ„Ÿåˆ†æ
curl -X POST "https://palonaai-food-recommendation.onrender.com/api/analyze-emotion" \
  -H "Content-Type: application/json" \
  -d '{"message": "è¿™ä¸ªæ¨èå¤ªæ£’äº†ï¼"}'
```

## ğŸ“Š æ€§èƒ½åŸºå‡†

### é¢„æœŸæ€§èƒ½æŒ‡æ ‡
- **å“åº”æ—¶é—´**: < 3ç§’ (95%çš„è¯·æ±‚)
- **ç”¨æˆ·æ»¡æ„åº¦**: > 80%
- **æ„å›¾è¯†åˆ«å‡†ç¡®ç‡**: > 85%
- **æƒ…æ„Ÿè¯†åˆ«å‡†ç¡®ç‡**: > 80%
- **APIå¯ç”¨æ€§**: > 99%

### ç›‘æ§å»ºè®®
1. **å®šæœŸæµ‹è¯•**: å»ºè®®æ¯å¤©è¿è¡Œä¸€æ¬¡å®Œæ•´æµ‹è¯•
2. **æ€§èƒ½ç›‘æ§**: ç›‘æ§å“åº”æ—¶é—´å’Œé”™è¯¯ç‡
3. **ç”¨æˆ·åé¦ˆ**: æ”¶é›†çœŸå®ç”¨æˆ·åé¦ˆæ•°æ®
4. **æŒ‡æ ‡è¶‹åŠ¿**: è§‚å¯ŸæŒ‡æ ‡å˜åŒ–è¶‹åŠ¿ï¼ŒåŠæ—¶å‘ç°é—®é¢˜

## âœ… æµ‹è¯•æ£€æŸ¥æ¸…å•

### åŸºç¡€åŠŸèƒ½æµ‹è¯•
- [ ] å¥åº·æ£€æŸ¥æ­£å¸¸
- [ ] å¯¹è¯åˆ›å»ºæˆåŠŸ
- [ ] æŒ‡æ ‡APIå¯è®¿é—®
- [ ] åé¦ˆæäº¤æˆåŠŸ
- [ ] ä¼šè¯ä¿¡æ¯è·å–æ­£å¸¸

### æŒ‡æ ‡å‡†ç¡®æ€§æµ‹è¯•
- [ ] ç”¨æˆ·æ»¡æ„åº¦è®¡ç®—æ­£ç¡®
- [ ] å“åº”æ—¶é—´ç»Ÿè®¡å‡†ç¡®
- [ ] æ„å›¾è¯†åˆ«å‡†ç¡®ç‡åˆç†
- [ ] æƒ…æ„Ÿè¯†åˆ«å‡†ç¡®ç‡åˆç†
- [ ] å¯¹è¯é•¿åº¦ç»Ÿè®¡æ­£ç¡®

### å®æ—¶ç›‘æ§æµ‹è¯•
- [ ] æŒ‡æ ‡å®æ—¶æ›´æ–°
- [ ] å¤šä¼šè¯æŒ‡æ ‡ç‹¬ç«‹
- [ ] åé¦ˆå½±å“æŒ‡æ ‡å˜åŒ–
- [ ] æ€§èƒ½æŒ‡æ ‡ç¨³å®š

### å¼‚å¸¸æƒ…å†µæµ‹è¯•
- [ ] æ— æ•ˆä¼šè¯IDå¤„ç†
- [ ] ç½‘ç»œé”™è¯¯å¤„ç†
- [ ] æœåŠ¡å¼‚å¸¸æ¢å¤
- [ ] æ•°æ®ä¸€è‡´æ€§æ£€æŸ¥

---

**æµ‹è¯•å·¥å…·**: `test_conversation_metrics.py`  
**æµ‹è¯•ç¯å¢ƒ**: æœ¬åœ°/çº¿ä¸Š  
**æµ‹è¯•é¢‘ç‡**: å»ºè®®æ¯æ—¥ä¸€æ¬¡  
**ç»´æŠ¤äººå‘˜**: å¼€å‘å›¢é˜Ÿ 